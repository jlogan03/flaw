//! Butterworth filter of order 5.
//! Region of validity: cutoff ratio from 3.16e-02 to 4.00e-01 .
//! This file is autogenerated.
#![allow(clippy::style)]

use crate::SisoIirFilter;

/// Minimum tabulated cutoff ratio
#[allow(dead_code)]
pub const MIN_CUTOFF_RATIO: f64 = 0.03162277660168379;

/// Maximum tabulated cutoff ratio
#[allow(dead_code)]
pub const MAX_CUTOFF_RATIO: f64 = 0.4;

/// Initialise a Butterworth filter of order 5 by interpolating the coefficients from stored tables.
/// Cutoff ratio is the dimensionless ratio of the cutoff frequency to the sampling frequency.
/// Region of validity: cutoff ratio from 3.16e-02 to 4.00e-01
pub fn butter5(cutoff_ratio: f64) -> Result<SisoIirFilter<5>, &'static str> {
    let avals = &[
        &AVALS[0][..],
        &AVALS[1][..],
        &AVALS[2][..],
        &AVALS[3][..],
        &AVALS[4][..],
    ];
    let cvals = &[
        &CVALS[0][..],
        &CVALS[1][..],
        &CVALS[2][..],
        &CVALS[3][..],
        &CVALS[4][..],
    ];
    SisoIirFilter::new_interpolated(cutoff_ratio, &LOG10_CUTOFF_RATIOS, avals, cvals, &DVALS)
}

/// [dimensionless] Log base-10 of cutoff ratios, to improve float precision during interpolation
#[rustfmt::skip]
const LOG10_CUTOFF_RATIOS: [f64; 100] = [-1.5, -1.4888680808956771, -1.4777361617913543, -1.4666042426870314, -1.4554723235827085, -1.4443404044783856, -1.433208485374063, -1.42207656626974, -1.4109446471654172, -1.3998127280610944, -1.3886808089567715, -1.3775488898524486, -1.3664169707481257, -1.3552850516438029, -1.34415313253948, -1.3330212134351571, -1.3218892943308345, -1.3107573752265116, -1.2996254561221887, -1.2884935370178658, -1.277361617913543, -1.26622969880922, -1.2550977797048972, -1.2439658606005743, -1.2328339414962515, -1.2217020223919286, -1.2105701032876057, -1.199438184183283, -1.18830626507896, -1.1771743459746373, -1.1660424268703145, -1.1549105077659916, -1.1437785886616687, -1.1326466695573458, -1.121514750453023, -1.1103828313487, -1.0992509122443774, -1.0881189931400543, -1.0769870740357317, -1.0658551549314088, -1.054723235827086, -1.043591316722763, -1.0324593976184402, -1.0213274785141173, -1.0101955594097944, -0.9990636403054716, -0.9879317212011488, -0.9767998020968259, -0.9656678829925031, -0.9545359638881802, -0.9434040447838573, -0.9322721256795345, -0.9211402065752117, -0.9100082874708888, -0.8988763683665659, -0.887744449262243, -0.8766125301579202, -0.8654806110535974, -0.8543486919492745, -0.8432167728449517, -0.8320848537406288, -0.8209529346363059, -0.8098210155319832, -0.7986890964276603, -0.7875571773233374, -0.7764252582190145, -0.7652933391146917, -0.7541614200103689, -0.743029500906046, -0.7318975818017232, -0.7207656626974003, -0.7096337435930774, -0.6985018244887546, -0.6873699053844318, -0.6762379862801089, -0.665106067175786, -0.6539741480714631, -0.6428422289671403, -0.6317103098628175, -0.6205783907584946, -0.6094464716541718, -0.5983145525498489, -0.587182633445526, -0.5760507143412033, -0.5649187952368804, -0.5537868761325575, -0.5426549570282346, -0.5315230379239118, -0.5203911188195889, -0.5092591997152661, -0.49812728061094314, -0.4869953615066205, -0.4758634424022976, -0.46473152329797474, -0.4535996041936519, -0.442467685089329, -0.4313357659850061, -0.42020384688068324, -0.40907192777636037, -0.3979400086720376];

/// State-Space `D` 1x1 matrix
#[rustfmt::skip]
const DVALS: [f64; 100] = [7.128588805140271e-06, 8.042532779924618e-06, 9.072064390085749e-06, 1.0231560741876906e-05, 1.1537151072305585e-05, 1.3006924975964882e-05, 1.4661164617961338e-05, 1.6522603590443047e-05, 1.8616715350638598e-05, 2.0972034486566155e-05, 2.362051439522614e-05, 2.6597925329946336e-05, 2.994429718162656e-05, 3.3704411806225894e-05, 3.79283502015111e-05, 4.2672100373723636e-05, 4.7998232323634665e-05, 5.397664722602033e-05, 6.068540858188881e-05, 6.821166389425443e-05, 7.665266626178779e-05, 8.611690620674681e-05, 9.672536506125231e-05, 0.00010861290233696517, 0.00012192979070600919, 0.00013684341353490602, 0.00015354014134861247, 0.000172227405169834, 0.00019313598639218648, 0.0002165225447184654, 0.00024267240774280478, 0.00027190264799518, 0.00030456547571805893, 0.0003410519783297646, 0.0003817962404719708, 0.00042727988176746414, 0.0004780370529603524, 0.0005346599350100867, 0.0005978047900036769, 0.0006681986174839754, 0.0007466464750188085, 0.0008340395276175933, 0.0009313638970084834, 0.0010397103889013565, 0.0011602851842729483, 0.0012944215895279566, 0.0014435929502387504, 0.0016094268441905783, 0.0017937206818268742, 0.0019984588560949417, 0.0022258315993629297, 0.0024782557227786177, 0.0027583974334773513, 0.0030691974477805384, 0.003413898644378363, 0.0037960765309539195, 0.004219672831359124, 0.004689032538973996, 0.005208944826069671, 0.005784688249790884, 0.006422080753886906, 0.007127535032860114, 0.007908119903323272, 0.008771628417898709, 0.009726653562145466, 0.01078267249736892, 0.01195014045486182, 0.013240595553868601, 0.014666776010817407, 0.01624275143649127, 0.01798407018727851, 0.01990792505426553, 0.02203333994918283, 0.024381380690600845, 0.02697539352132258, 0.02984127561579961, 0.033007782585651076, 0.036506878887902695, 0.04037413811637819, 0.04464920145142537, 0.04937630410616821, 0.05460488150033772, 0.060390269192649636, 0.06679451340684332, 0.07388731241769599, 0.08174711327751334, 0.09046239355965638, 0.1001331642284614, 0.11087273774273168, 0.12280981548788722, 0.13609096116326885, 0.15088354255077152, 0.16737924411390617, 0.18579827838900614, 0.2063944568237202, 0.2294613228665127, 0.2553396047969119, 0.2844263172206057, 0.31718593413785984, 0.35416418109342973];

/// State-Space `A` matrix, first row
#[rustfmt::skip]
const AVALS: [[f64; 100]; 5] = [[4.357324835090829, 4.340654970975603, 4.323553574283822, 4.306009539833572, 4.288011481614226, 4.269547726041229, 4.250606305072513, 4.231174949184927, 4.211241080209233, 4.19079180402213, 4.1698139030937815, 4.148293828889359, 4.126217694123005, 4.103571264862666, 4.080339952484083, 4.056508805472193, 4.032062501068073, 4.006985336759308, 3.9812612216115735, 3.9548736674388785, 3.927805779809597, 3.9000402488850994, 3.871559340087229, 3.842344884590408, 3.812378269633421, 3.7816404286452237, 3.750111831178165, 3.7177724726410126, 3.684601863822914, 3.6505790201980943, 3.6156824509994188, 3.5798901480471983, 3.5431795743174765, 3.5055276522317174, 3.4669107516471556, 3.4273046775240252, 3.386684657242567, 3.345025327538892, 3.3023007210246114, 3.2584842522503727, 3.2135487032683345, 3.167466208642739, 3.1202082398514386, 3.071745589014205, 3.0220483518759425, 2.9710859099645357, 2.918826911833868, 2.865239253292554, 2.8102900565081432, 2.7539456478648336, 2.6961715344401855, 2.6369323789528236, 2.576191973018746, 2.5139132085385416, 2.450058047021631, 2.384587486636644, 2.3174615267591943, 2.248639129769869, 2.1780781798361204, 2.1057354383923856, 2.031566496013007, 1.9555257203530967, 1.8775661998133288, 1.7976396825664438, 1.7156965105664888, 1.631685548147051, 1.545554104803013, 1.4572478517424092, 1.3667107317921974, 1.2738848622456416, 1.1787104302512077, 1.0811255803657607, 0.9810662939310523, 0.8784662599850246, 0.7732567374925559, 0.665366408778294, 0.5547212241730324, 0.4412442380513455, 0.3248554366500985, 0.20547155832456426, 0.08300590723285584, -0.04263183814639903, -0.171535819747713, -0.3038041953632249, -0.43953933149670243, -0.5788479894055154, -0.7218414990033426, -0.8686359139775767, -1.0193521399157985, -1.1741160254101624, -1.3330584039985651, -1.4963150724020235, -1.664026687847662, -1.8363385643831354, -2.0134003451105618, -2.195365524406636, -2.382390791798595, -2.5746351677754866, -2.772258902242679, -2.9754221097456828], [-7.630996244799899, -7.574785497541563, -7.517387882693942, -7.458786422346189, -7.398964384420908, -7.337905321790231, -7.2755931138559085, -7.212012010712084, -7.147146680014316, -7.080982256682647, -7.013504395571363, -6.944699327242781, -6.874553916987337, -6.80305572723721, -6.730193083525817, -6.655955144150747, -6.580331973703143, -6.50331462063184, -6.4248951990164676, -6.345066974729405, -6.263824456172446, -6.181163489780517, -6.097081360490963, -6.011576897384026, -5.924650584707022, -5.836304678502453, -5.746543329068188, -5.655372709486504, -5.5628011504678785, -5.468839281765626, -5.373500180428096, -5.276799526167362, -5.178755764136336, -5.079390275420994, -4.9787275555707, -4.87679540150795, -4.7736251071794245, -4.669251668333591, -4.563713996836415, -4.457055144966616, -4.349322540166102, -4.240568230759803, -4.130849143203429, -4.020227351468137, -3.908770359228513, -3.796551395586131, -3.6836497251357643, -3.57015097326689, -3.4561474676906543, -3.3417385972934732, -3.227031189545033, -3.1121399078323115, -2.9971876702549003, -2.8823060916027616, -2.7676359504484074, -2.6533276835247026, -2.539541909830281, -2.4264499872112557, -2.314234604514507, -2.2030904127997033, -2.093224699539337, -1.9848581102351632, -1.8782254224417914, -1.7735763778218616, -1.671176578570567, -1.5713084553497263, -1.4742723147739514, -1.3803874755051952, -1.289993503150325, -1.2034515554338348, -1.121145850550168, -1.0434852732051043, -0.9709051346524029, -0.9038691050410209, -0.8428713386324532, -0.7884388149503967, -0.741133921711067, -0.7015573084770202, -0.6703510434049335, -0.6482021092411153, -0.6358462788763203, -0.6340724153155665, -0.643727245850237, -0.6657206655232141, -0.7010316306136608, -0.7507147087620591, -0.8159073583855231, -0.89783801600827, -0.9978350757707041, -1.1173368502776047, -1.2579026055314015, -1.4212247641842906, -1.6091423696674125, -1.8236558974949686, -2.0669434873350414, -2.3413786478957657, -2.649549453299641, -2.9942792007737844, -3.378648430952464, -3.806018119320411], [6.711007082430998, 6.639436549001, 6.566666942068248, 6.492696677242762, 6.4175253062558495, 6.34115358164878, 6.263583523203269, 6.184818486053648, 6.104863230408596, 6.023723992796437, 5.941408558733665, 5.857926336700448, 5.773288433290131, 5.687507729381323, 5.600598957161881, 5.5125787778130135, 5.423465859639681, 5.33328095640933, 5.242046985636013, 5.1497891065198, 5.056534797222774, 4.962313931132758, 4.867158851733598, 4.771104445667048, 4.674188213535326, 4.576450337955653, 4.477933748338142, 4.3786841818164275, 4.278750239716096, 4.1781834388996035, 4.077038257277104, 3.9753721727213733, 3.8732456945704983, 3.770722386845018, 3.6678688822459042, 3.564754885936202, 3.461453168041819, 3.3580395437358534, 3.25459283969497, 3.151194845635692, 3.0479302495522482, 2.944886555184844, 2.842153980147338, 2.739825333035104, 2.63799586771584, 2.536763112877156, 2.4362266747626666, 2.336488010871157, 2.2376501722185664, 2.139817511566904, 2.0430953548044086, 1.9475896324128814, 1.8534064676763589, 1.7606517179642487, 1.6694304650548464, 1.5798464500438705, 1.4920014478976105, 1.4059945761506696, 1.321921531600717, 1.2398737481022064, 1.1599374676892458, 1.0821927162440397, 1.0067121737461941, 0.933559927760785, 0.8627900972146629, 0.794445311630308, 0.7285550287866316, 0.6651336711993419, 0.6041785587924801, 0.5456676115875154, 0.4895567920716352, 0.43577725200959466, 0.3842321426985458, 0.3347930408713864, 0.28729593443862944, 0.24153670279027034, 0.19726601518042844, 0.15418355745520324, 0.11193148165710953, 0.07008695436414851, 0.0281536574149798, -0.01444793177034033, -0.058391684592454626, -0.10445863235765106, -0.153551731003023, -0.20671292027236793, -0.26514288267205827, -0.3302239848997678, -0.4035469772648995, -0.4869421380389746, -0.5825156834122168, -0.6926924241873178, -0.8202658426515929, -0.9684569931491855, -1.1409839043920402, -1.3421434877792193, -1.5769083414947853, -1.8510412921030377, -2.171231039383059, -2.5452528683304663], [-2.962598105056169, -2.9218512666962115, -2.8805858126005828, -2.8388096160037986, -2.7965314078400936, -2.7537608046446747, -2.710508335971048, -2.666785471194812, -2.6226046455658314, -2.5779792853617214, -2.5329238319867358, -2.48745376485117, -2.4415856228575232, -2.3953370243107335, -2.3487266850611954, -2.3017744346807163, -2.2545012304635437, -2.206929169036635, -2.159081495356332, -2.110982608861799, -2.0626580665497203, -2.0141345827297794, -1.9654400252162776, -1.9166034077084655, -1.8676548781104627, -1.8186257025415675, -1.7695482447892346, -1.720455940960351, -1.6713832690917707, -1.62236571348875, -1.5734397235698392, -1.5246426670096593, -1.4760127769865414, -1.4275890933608741, -1.3794113976322615, -1.3315201415495759, -1.2839563692779468, -1.2367616330611166, -1.1899779023564978, -1.1436474664642904, -1.0978128307214616, -1.0525166063865703, -1.007801394403014, -0.9637096632966693, -0.9202836215396871, -0.8775650847961891, -0.835595338558434, -0.794414996784698, -0.7540638572637124, -0.7145807545562546, -0.6760034115039987, -0.638368290450757, -0.6017104454940642, -0.5660633772782689, -0.531458892057169, -0.4979269669986821, -0.4654956239807795, -0.4341908144428109, -0.404036318216363, -0.3750536596736226, -0.34726204500923824, -0.3206783250268304, -0.2953169884491068, -0.2711901915302553, -0.24830783064430212, -0.2266776655821617, -0.20630550254850238, -0.1871954473505807, -0.16935024106826393, -0.1527716926533895, -0.13746122550863626, -0.12342055824195114, -0.1106525436071224, -0.09916219427966654, -0.08895792977351417, -0.08005308572012192, -0.07246773521117246, -0.06623088233053112, -0.061383100851808224, -0.057979706963379854, -0.05609457457541816, -0.055824726246672264, -0.057295863298591286, -0.060669036871102984, -0.0661487095894488, -0.0739925178293904, -0.0845231207546011, -0.09814261886309034, -0.11535014760488951, -0.13676340843521914, -0.1631451005956094, -0.1954354753752901, -0.23479256836965579, -0.28264209797392104, -0.3407395816191514, -0.4112479574138468, -0.49683496482123046, -0.6007958105217026, -0.7272083283558289, -0.8811300754378363], [0.5250343174924763, 0.5162878832122129, 0.5074628728819726, 0.49856241132991413, 0.489589815556612, 0.48054859714566506, 0.4714424642833993, 0.46227532335342636, 0.45305128007109735, 0.44377464012223145, 0.4344499092700067, 0.4250817928935867, 0.4156751949219131, 0.40623521612615515, 0.3967671517346005, 0.3872764883342984, 0.37776890002457675, 0.3682502437886044, 0.3587265540505929, 0.34920403638790837, 0.3396890603694191, 0.3301881514938229, 0.3207079822044533, 0.3112553619602527, 0.3018372263461455, 0.29246062521002664, 0.2831327098179601, 0.2738607190239795, 0.2646519644560885, 0.2555138147256883, 0.246453678673643, 0.23747898767260345, 0.22859717701192508, 0.21981566639858008, 0.21114183961479788, 0.2025830233807397, 0.19414646547825448, 0.18583931219963962, 0.1776685851932128, 0.16964115778535385, 0.16176373086637877, 0.15404280843502738, 0.14648467290339598, 0.13909536027065353, 0.13188063527968277, 0.12484596667573336, 0.11799650269002313, 0.11133704687377852, 0.10487203440919703, 0.09860550902295198, 0.09254110062482393, 0.08668200378844762, 0.08103095718258432, 0.07559022404926295, 0.07036157380899127, 0.0653462648523451, 0.0605450285507637, 0.055958054486360424, 0.05158497685980304, 0.04742486198542558, 0.04347619672194166, 0.039736877613333416, 0.036204200425030454, 0.03287484965212953, 0.029744887445062963, 0.026809741238723917, 0.024064189177230945, 0.02150234219023012, 0.019117621287754752, 0.016902728286346466, 0.01484960774304878, 0.012949397335203477, 0.011192363256076648, 0.009567816365049504, 0.008064003792459475, 0.006667969396366342, 0.005365374827944479, 0.004140270888116432, 0.0029748062254312457, 0.0018488570701707954, 0.0007395574065201047, -0.0003792965318291841, -0.0015380006757927831, -0.002771898903794115, -0.0041225946634356955, -0.005639488611093473, -0.0073817330934801886, -0.009420721562060171, -0.011843267211122895, -0.01475567345042907, -0.018288963686810975, -0.022605625475765608, -0.027908343108675144, -0.03445135544698774, -0.04255529990225382, -0.05262671423293637, -0.06518380208693073, -0.08089067988536891, -0.10060319147748292, -0.1254306221553556]];

/// State-Space `C` vector
#[rustfmt::skip]
const CVALS: [[f64; 100]; 5] = [[6.67045210654895e-05, 7.512252379003712e-05, 8.458387837031696e-05, 9.521500187129315e-05, 0.00010715719162469215, 0.00012056831183374414, 0.0001356246618546192, 0.0001525230443594108, 0.0001714830532163641, 0.00019274960267280167, 0.00021659572129957146, 0.00024332563615720804, 0.00027327817477703796, 0.0003068305148182561, 0.00034440231366658896, 0.00038646025278262137, 0.00043352303428785413, 0.0004861668700921951, 0.0005450315068141722, 0.0006108268328188503, 0.0006843401168898052, 0.0007664439313495096, 0.0008581048158324998, 0.0009603927413797815, 0.0010744914380385864, 0.0012017096526919476, 0.0013434934073752619, 0.0015014393318239692, 0.0016773091473928597, 0.0018730453827414605, 0.0020907884047314585, 0.0023328948507617903, 0.0026019575511968063, 0.0029008270325321453, 0.003232634693390592, 0.0036008177462308628, 0.00400914601765604, 0.004461750699279472, 0.004963155139079493, 0.005518307759866881, 0.006132617186690607, 0.006811989658489046, 0.007562868790788433, 0.008392277745466768, 0.00930786385020288, 0.010317945693840192, 0.011431562704084266, 0.012658527190230497, 0.014009478805425442, 0.015495941349654308, 0.01713038179547445, 0.018926271372613157, 0.02089814849390662, 0.023061683242490968, 0.025433743067267263, 0.028032459248797353, 0.030877293598981427, 0.033989104742771066, 0.03739021319598096, 0.041104464296591106, 0.04515728786372113, 0.04957575324377628, 0.05438861815116718, 0.05962636941423577, 0.0653212533867894, 0.07150729337120414, 0.07822029090729332, 0.08549780719600811, 0.09337912022886354, 0.10190515235862123, 0.11111836204450753, 0.12106259229949853, 0.13178286691278193, 0.14332512376154743, 0.1557358723934886, 0.1690617604688459, 0.18334903049140502, 0.19864284439803884, 0.21498644884905838, 0.23242014825729862, 0.25098004544897895, 0.2706965010315629, 0.29159225163250196, 0.31368011363397247, 0.3369601821823178, 0.3614164142271732, 0.3870124580277492, 0.4136865585132506, 0.44134532623728173, 0.4698561049974425, 0.4990376063294063, 0.5286483938577261, 0.5583726913722222, 0.5878028481433051, 0.6164176135208157, 0.6435551369266813, 0.6683793007349041, 0.6898375871459904, 0.7066081411094571, 0.7170329705617839], [1.6887653648654703e-05, 1.9504867134370556e-05, 2.252241698380767e-05, 2.6000581077847293e-05, 3.0008540841383344e-05, 3.462566575838985e-05, 3.9942977844065964e-05, 4.606482036192062e-05, 5.311075819529776e-05, 6.121774077975003e-05, 7.05425624156862e-05, 8.126465915453133e-05, 9.358928633488187e-05, 0.00010775112629075247, 0.00012401838181935596, 0.00014269741774303348, 0.00016413802039590174, 0.00018873935318253822, 0.00021695669557075797, 0.0002493090630757684, 0.000286387817056467, 0.00032886638556947146, 0.0003775112302108779, 0.00043319420892292434, 0.0004969065012605296, 0.0005697742807130422, 0.0006530763384750691, 0.0007482638846751859, 0.0008569827766226612, 0.0009810984492404562, 0.0011227238506371657, 0.0012842507158471832, 0.0014683845442487662, 0.0016781836811563483, 0.0019171029416686094, 0.0021890422551142114, 0.0024984008514299257, 0.0028501375565638896, 0.0032498378125211352, 0.0037037880889232216, 0.004219058406853214, 0.004803593752162854, 0.005466315214116734, 0.0062172317459467585, 0.007067563506191389, 0.008029877803080385, 0.009118238728032604, 0.010348371627716933, 0.011737843626028437, 0.013306261466433987, 0.01507548799981022, 0.01706987869111303, 0.019316539557492435, 0.02184560797773589, 0.02469055782441499, 0.02788853036118074, 0.03148069231258254, 0.03551262244551334, 0.04003472789119948, 0.045102691273759446, 0.05077794948239679, 0.057128204612643486, 0.06422796718709302, 0.07215913122197098, 0.08101158000052718, 0.09088382050730646, 0.10188364331835523, 0.11412880326789601, 0.12774771434205856, 0.14288014988414213, 0.15967793620631482, 0.17830562392845828, 0.19894111660162475, 0.22177623016153064, 0.2470171491657714, 0.2748847361748669, 0.3056146385018209, 0.3394571211855334, 0.37667653555089287, 0.4175503079575083, 0.46236730183110947, 0.5114253659024378, 0.5650278302629577, 0.6234786461499303, 0.6870757810711214, 0.7561023724388659, 0.830815003034073, 0.9114282807771019, 0.9980946707608926, 1.0908782224584623, 1.1897204369961398, 1.2943959983267046, 1.4044554076324705, 1.5191506577615386, 1.63733888988336, 1.7573573867875576, 1.8768611376737148, 1.9926113663997107, 2.1001995826835262, 2.193686520478429], [0.0001191258980104374, 0.0001338232138848163, 0.0001502938692275481, 0.00016874602785056072, 0.00018941146969167374, 0.0002125481586572255, 0.00023844307531164675, 0.000267415340028339, 0.0002998196545214828, 0.00033605009218014444, 0.0003765442703417497, 0.000421787940591348, 0.0004723200363779525, 0.0005287382207244198, 0.0005917049806005647, 0.000661954318662132, 0.0007402990975666331, 0.000827639097001562, 0.0009249698489476681, 0.0010333923226027658, 0.001154123536870512, 0.0012885081854432608, 0.001438031367357561, 0.001604332524566347, 0.0017892206976569491, 0.001994691221467886, 0.002222943994155685, 0.002476403466390781, 0.0027577405119952373, 0.003069896357675745, 0.0034161087677810112, 0.003799940700481093, 0.004225311674720377, 0.004696532113063472, 0.005218340954505324, 0.005795946863867451, 0.006435073401014511, 0.007142008554315979, 0.007923659089118091, 0.008787610214116153, 0.009742191127119468, 0.010796547067549702, 0.011960718576933031, 0.013245728751545283, 0.014663679364213433, 0.016227856836105902, 0.017952849155258483, 0.019854674967731273, 0.02195092621087065, 0.024260925817367336, 0.02680590219486457, 0.029609182379937704, 0.0326964059784023, 0.03609576223701168, 0.03983825284531831, 0.043957983341061595, 0.04849248628763326, 0.0534830797069314, 0.058975264583198364, 0.06501916559977985, 0.07167001962582849, 0.07898871682593657, 0.08704239961135282, 0.09590512497114505, 0.10565859599391149, 0.116392968586069, 0.12820773947171435, 0.1412127214682963, 0.15552911170052183, 0.17129065774687258, 0.1886449255820603, 0.20775467141601608, 0.22879931691130828, 0.2519765234880576, 0.2775038561017839, 0.3056205194772921, 0.33658913959712405, 0.37069754933755006, 0.4082605182637769, 0.44962134105877544, 0.49515316461190506, 0.5452598874011328, 0.6003764023753457, 0.6609678705489597, 0.7275275994560615, 0.8005729482657026, 0.8806384757947422, 0.9682652697724685, 1.0639850192501534, 1.1682968807530283, 1.2816344923844414, 1.404319538648251, 1.5364969644235817, 1.6780451418691493, 1.8284518150455993, 1.986643208482632, 2.150748895250887, 2.317778314469918, 2.4831753959227663, 2.6402044131463347], [1.452380033986817e-05, 1.6713579309154542e-05, 1.9227461977348778e-05, 2.2112350688617412e-05, 2.542175003082934e-05, 2.9216664692058447e-05, 3.356661417777869e-05, 3.8550778750910486e-05, 4.425929258943148e-05, 5.079470195457158e-05, 5.8273608140676654e-05, 6.682851715052639e-05, 7.660992042290034e-05, 8.77886335490608e-05, 0.00010055842276892022, 0.00011513895215425166, 0.00013177908778446394, 0.00015076059892019702, 0.0001724023002021496, 0.00019706468326897476, 0.00022515509092151876, 0.00025713349208502853, 0.00029351892136122017, 0.0003348966529446916, 0.0003819261851309801, 0.0004353501185964253, 0.0004960040191149342, 0.0005648273634285435, 0.0006428756756454959, 0.0007313339708437542, 0.0008315316325571578, 0.0009449588615695402, 0.0010732848450014554, 0.001218377807116102, 0.0013823271166796697, 0.0015674676401850208, 0.0017764065459024586, 0.002012052780695008, 0.0022776494599911425, 0.002576809431439387, 0.0029135542948054427, 0.003292357184887639, 0.0037181896509406428, 0.004196572995692607, 0.0047336344699631895, 0.005336168755663664, 0.006011705211198435, 0.0067685813997000275, 0.007616023472942302, 0.008564234043136755, 0.009624488242211907, 0.010809238744843096, 0.012132230618839416, 0.013608626966078195, 0.01525514643075502, 0.017090213781216834, 0.019134124919167363, 0.021409227837824018, 0.023940121241030992, 0.026753872750799348, 0.029880258873625297, 0.03335202916839293, 0.037205197362472485, 0.04147936249881136, 0.04621806356528231, 0.051469171456404034, 0.057285322542243645, 0.06372439856144846, 0.07085005800096088, 0.07873232455215531, 0.08744823860881593, 0.09708257804769127, 0.10772865463637664, 0.11948919224415636, 0.13247729244413017, 0.14681749188412868, 0.16264691367993045, 0.18011651163963383, 0.19939240079008846, 0.22065725964082428, 0.24411177775789908, 0.26997610494020025, 0.298491233355021, 0.3299202082375495, 0.36454901171701687, 0.4026868916508791, 0.44466580398368877, 0.49083849016987785, 0.541574502049676, 0.5972531884840122, 0.6582522322672095, 0.7249297158891398, 0.7975968179522552, 0.8764769767412195, 0.9616455232519745, 1.052941113998231, 1.1498363804178189, 1.2512494463147716, 1.355269417746924, 1.4587561938629154], [1.08713425631316e-05, 1.2194795004536732e-05, 1.3675800248448904e-05, 1.533263233701554e-05, 1.7185622737844444e-05, 1.9257384526343718e-05, 2.1573060194717614e-05, 2.416059550785559e-05, 2.705104207096466e-05, 3.0278891543473077e-05, 3.3882444731143024e-05, 3.790421911644967e-05, 4.239139874939888e-05, 4.739633082073301e-05, 5.297707368095712e-05, 5.919800155630803e-05, 6.613047175165821e-05, 7.385356072589382e-05, 8.245487608362205e-05, 9.203145225486343e-05, 0.00010269073843906515, 0.00011455168827951946, 0.00012774596171803566, 0.00014241925056741083, 0.00015873274054167705, 0.00017686472381319885, 0.00019701237763447774, 0.00021939372618527897, 0.000244249804598043, 0.0002718470460935939, 0.00030247991534360926, 0.0003364738135865756, 0.0003741882836825012, 0.0004160205462228759, 0.00046240940104323643, 0.000513839532045682, 0.000570846257160246, 0.0006340207695930652, 0.0007040159212653559, 0.0007815526045845297, 0.0008674267944560814, 0.0009625173187976311, 0.0010677944328158033, 0.001184329280022732, 0.0013133043314804685, 0.0014560249041585137, 0.0016139318696748956, 0.001788615676182142, 0.0019818318188919103, 0.00219551790886161, 0.002431812505373487, 0.002693075894729256, 0.002981913017802005, 0.0033011987705096955, 0.0036541059258212065, 0.004044135953345406, 0.004475153043408644, 0.00495142167727822, 0.005477648124386465, 0.00605902629166593, 0.006701288400107089, 0.007410761020145622, 0.00819442706128836, 0.009059994383341475, 0.010015971777568604, 0.011071753156885286, 0.012237710895462096, 0.013525299370270324, 0.014947169880104541, 0.016517298250644945, 0.018251126575183053, 0.020165720685912665, 0.022279945093638707, 0.02461465726377488, 0.027192923196981612, 0.030040256328354293, 0.033184881711462395, 0.03665802725577827, 0.04049424335379321, 0.04473175144320632, 0.049412820717576515, 0.0545841700581637, 0.060297388917820036, 0.06660936576835143, 0.07358270497782719, 0.08128610136319504, 0.08979462431540164, 0.09918983756913702, 0.10955964228321576, 0.12099767395404051, 0.13360199851645063, 0.14747272569741204, 0.1627079667399046, 0.17939727585878812, 0.197611278815424, 0.21738552740050518, 0.23869559853287492, 0.26141887904333927, 0.28527601687182447, 0.3097411475137388]];

#[cfg(feature = "std")]
#[cfg(test)]
#[rustfmt::skip]
mod test {
    use super::*;
    const CUTOFF_TEST_INPUT: [f32; 101] = [0.0, 0.5877852522924732, -0.9510565162951536, 0.9510565162951535, -0.5877852522924728, -4.898587196589413e-16, 0.5877852522924737, -0.9510565162951538, 0.9510565162951533, -0.5877852522924724, -9.797174393178826e-16, 0.587785252292474, -0.951056516295154, 0.9510565162951532, -0.587785252292472, -1.4695761589768238e-15, 0.5877852522924744, -0.9510565162951541, 0.951056516295153, -0.5877852522924716, -1.959434878635765e-15, 0.5877852522924748, -0.9510565162951542, 0.9510565162951529, -0.5877852522924712, -2.4492935982947065e-15, 0.5877852522924751, -0.9510565162951544, 0.9510565162951528, -0.5877852522924709, -2.9391523179536475e-15, 0.5877852522924756, -0.9510565162951545, 0.9510565162951525, -0.5877852522924705, -3.429011037612589e-15, 0.587785252292476, -0.9510565162951546, 0.9510565162951524, -0.58778525229247, -3.91886975727153e-15, 0.5877852522924764, -0.9510565162951549, 0.9510565162951523, -0.5877852522924696, -4.408728476930472e-15, 0.5877852522924768, -0.951056516295155, 0.9510565162951521, -0.5877852522924693, -4.898587196589413e-15, 0.5877852522924887, -0.9510565162951552, 0.9510565162951563, -0.5877852522924689, -1.9599300631450357e-14, 0.5877852522924776, -0.9510565162951509, 0.9510565162951518, -0.5877852522924569, -5.878304635907295e-15, 0.5877852522924665, -0.9510565162951554, 0.9510565162951473, -0.587785252292468, 7.842691359635767e-15, 0.5877852522924784, -0.95105651629516, 0.9510565162951515, -0.5877852522924791, -6.858022075225178e-15, 0.5877852522924902, -0.9510565162951558, 0.9510565162951558, -0.5877852522924673, -2.1558735510086122e-14, 0.5877852522924791, -0.9510565162951515, 0.9510565162951512, -0.5877852522924554, -7.83773951454306e-15, 0.587785252292468, -0.9510565162951561, 0.9510565162951466, -0.5877852522924665, 5.883256481000002e-15, 0.5877852522924799, -0.9510565162951606, 0.9510565162951509, -0.5877852522924776, -8.817456953860943e-15, 0.5877852522924919, -0.9510565162951563, 0.9510565162951552, -0.5877852522924657, -2.3518170388721888e-14, 0.5877852522924807, -0.9510565162951521, 0.9510565162951506, -0.5877852522924538, -9.797174393178826e-15];
    const CUTOFF_TEST_OUTPUT: [f32; 101] = [0.0, 0.20817248253695878, 0.0846312532364365, -0.3097177262341411, 0.25898286035029705, 0.009372973898095042, -0.3071835272951864, 0.45106437907150543, -0.3557949885651552, 0.06422673819947916, 0.28448059836470707, -0.5254550446906006, 0.5437913795855674, -0.32378509991570786, -0.04635785092967576, 0.4134912277214284, -0.6242290513599532, 0.5882990116897443, -0.3152187207315274, -0.08964292716169187, 0.4672464923395198, -0.6680611990985355, 0.6111653921566338, -0.3161853514828959, -0.10416885760193384, 0.48782482797715865, -0.6861945217728819, 0.621753912279434, -0.31813150222973163, -0.108834639476131, 0.4955607848503057, -0.6935561523585928, 0.6264769606443641, -0.31950076415010015, -0.11023045591563513, 0.4984202394562104, -0.6965048623821704, 0.6285342703628972, -0.3202756770132118, -0.11059418179821445, 0.4994549703401456, -0.6976698259794568, 0.6294128480519023, -0.3206719080679928, -0.11066009296140428, 0.4998196415871681, -0.6981235286771428, 0.6297815508463205, -0.32086255854779433, -0.11065438425729607, 0.49994386326911405, -0.6982975812762373, 0.62993385198089, -0.3209505636598959, -0.11063935640787464, 0.4999842350023373, -0.698363270811409, 0.6299958415762036, -0.3209899525352313, -0.11062835262338858, 0.49999644685006983, -0.698387613585866, 0.6300207170070042, -0.3210071558361403, -0.11062202380322791, 0.4999996951629947, -0.6983964447021027, 0.6300305599250513, -0.32101451775451106, -0.11061875990305947, 0.5000003244858144, -0.6983995669211773, 0.6300343993837567, -0.3210176128387718, -0.11061718084158859, 0.5000003058095949, -0.6984006349567675, 0.6300358747977953, -0.3210188934601006, -0.11061644909097759, 0.500000190729735, -0.6984009841637938, 0.6300364326737657, -0.3210194155192501, -0.11061612059408674, 0.5000001024753539, -0.6984010908223464, 0.6300366398454351, -0.32101962533455464, -0.11061597677110713, 0.5000000508476359, -0.6984011197350267, 0.6300367151918191, -0.3210197084836012, -0.11061591509623817, 0.5000000239816661, -0.6984011256611072, 0.6300367419130121, -0.32101974096918773, -0.1106158891194439, 0.500000010909723];
    const STEP_TEST_MIN_OUTPUT: f32 = 0.9999999976766617;
    const STEP_TEST_MAX_OUTPUT: f32 = 1.0711971516552137;

    #[test]
    fn test() {
        println!("order 5");
        let mut filter = butter5(0.4).unwrap();
        let out = (0..CUTOFF_TEST_INPUT.len()).map(|i| {filter.update(CUTOFF_TEST_INPUT[i])}).collect::<Vec<f32>>();
        // Check overall match to reference output to catch phase error, etc
        (0..CUTOFF_TEST_INPUT.len()).for_each(|i| { let expected = CUTOFF_TEST_OUTPUT[i]; let rel_err = (out[i] - expected).abs() / expected.abs().max(1e-4); assert!(rel_err < 0.05); });
        // Check approximate attenuation at cutoff frequency; should be -3dB or 1/sqrt(2) magnitude
        let maxmag = out.iter().fold(0.0_f32, |a, b| a.abs().max(b.abs()));
        let attenuation_rel_err = (maxmag - 0.707).abs() / 0.707;
        println!("attenuation rel err {attenuation_rel_err}");
        assert!(attenuation_rel_err < 0.05);
        // Check convergence of step responses at min and max tabulated cutoff
        let mut filtermin = butter5(MIN_CUTOFF_RATIO).unwrap();
        (0..309).for_each(|_| {filtermin.update(1.0);});
        let step_min_final = filtermin.update(1.0);
        let step_min_rel_err = (step_min_final - STEP_TEST_MIN_OUTPUT).abs() / STEP_TEST_MIN_OUTPUT;
        println!("step min rel err {step_min_rel_err}");
        assert!(step_min_rel_err < 1e-3);
        let mut filtermax = butter5(MAX_CUTOFF_RATIO).unwrap();
        (0..1).for_each(|_| {filtermax.update(1.0);});
        let step_max_final = filtermax.update(1.0);
        let step_max_rel_err = (step_max_final - STEP_TEST_MAX_OUTPUT).abs() / STEP_TEST_MAX_OUTPUT;
        println!("step max rel err {step_max_rel_err}");
        assert!(step_max_rel_err < 1e-6);
    }
}

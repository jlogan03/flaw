//! Butterworth filter of order 6.
//! Region of validity: cutoff ratio from 5.62e-02 to 4.00e-01 .
//! This file is autogenerated.
#![allow(clippy::style)]

use crate::SisoIirFilter;

/// Minimum tabulated cutoff ratio
#[allow(dead_code)]
pub const MIN_CUTOFF_RATIO: f64 = 0.05623413251903491;

/// Maximum tabulated cutoff ratio
#[allow(dead_code)]
pub const MAX_CUTOFF_RATIO: f64 = 0.4;

/// Initialise a Butterworth filter of order 6 by interpolating the coefficients from stored tables.
/// Cutoff ratio is the dimensionless ratio of the cutoff frequency to the sampling frequency.
/// Region of validity: cutoff ratio from 5.62e-02 to 4.00e-01
pub fn butter6(cutoff_ratio: f64) -> Result<SisoIirFilter<6>, &'static str> {
    let avals = &[
        &AVALS[0][..],
        &AVALS[1][..],
        &AVALS[2][..],
        &AVALS[3][..],
        &AVALS[4][..],
        &AVALS[5][..],
    ];
    let cvals = &[
        &CVALS[0][..],
        &CVALS[1][..],
        &CVALS[2][..],
        &CVALS[3][..],
        &CVALS[4][..],
        &CVALS[5][..],
    ];
    SisoIirFilter::new_interpolated(cutoff_ratio, &LOG10_CUTOFF_RATIOS, avals, cvals, &DVALS)
}

/// [dimensionless] Log base-10 of cutoff ratios, to improve float precision during interpolation
#[rustfmt::skip]
const LOG10_CUTOFF_RATIOS: [f64; 100] = [-1.25, -1.2413933334209297, -1.2327866668418594, -1.224180000262789, -1.2155733336837187, -1.2069666671046484, -1.1983600005255781, -1.1897533339465076, -1.1811466673674373, -1.172540000788367, -1.1639333342092968, -1.1553266676302263, -1.146720001051156, -1.1381133344720857, -1.1295066678930155, -1.1209000013139452, -1.1122933347348747, -1.1036866681558044, -1.0950800015767341, -1.0864733349976639, -1.0778666684185936, -1.069260001839523, -1.0606533352604528, -1.0520466686813825, -1.043440002102312, -1.0348333355232417, -1.0262266689441715, -1.0176200023651012, -1.009013335786031, -1.0004066692069604, -0.9918000026278901, -0.9831933360488199, -0.9745866694697496, -0.9659800028906792, -0.9573733363116088, -0.9487666697325385, -0.9401600031534683, -0.9315533365743979, -0.9229466699953276, -0.9143400034162572, -0.9057333368371869, -0.8971266702581167, -0.8885200036790463, -0.8799133370999759, -0.8713066705209056, -0.8627000039418353, -0.8540933373627649, -0.8454866707836945, -0.8368800042046243, -0.828273337625554, -0.8196666710464837, -0.8110600044674133, -0.8024533378883429, -0.7938466713092727, -0.7852400047302024, -0.776633338151132, -0.7680266715720616, -0.7594200049929913, -0.7508133384139211, -0.7422066718348507, -0.7336000052557804, -0.72499333867671, -0.7163866720976397, -0.7077800055185693, -0.6991733389394991, -0.6905666723604288, -0.6819600057813584, -0.6733533392022881, -0.6647466726232177, -0.6561400060441475, -0.6475333394650771, -0.6389266728860068, -0.6303200063069364, -0.6217133397278661, -0.6131066731487957, -0.6045000065697255, -0.5958933399906552, -0.5872866734115848, -0.5786800068325145, -0.5700733402534441, -0.5614666736743739, -0.5528600070953035, -0.5442533405162332, -0.5356466739371628, -0.5270400073580925, -0.5184333407790221, -0.5098266741999519, -0.5012200076208816, -0.49261334104181115, -0.484006674462741, -0.47540000788367054, -0.46679334130460026, -0.4581866747255299, -0.4495800081464596, -0.4409733415673892, -0.432366674988319, -0.42376000840924855, -0.41515334183017827, -0.406546675251108, -0.3979400086720376];

/// State-Space `D` 1x1 matrix
#[rustfmt::skip]
const DVALS: [f64; 100] = [1.628518065956585e-05, 1.813385168089339e-05, 2.0188633485774343e-05, 2.2472026183817414e-05, 2.5008926346625894e-05, 2.7826875045538115e-05, 3.095633073054672e-05, 3.443096934841944e-05, 3.828801432080556e-05, 4.256859924588784e-05, 4.73181664517043e-05, 5.258690481756213e-05, 5.8430230594113955e-05, 6.490931529499072e-05, 7.209166510592355e-05, 8.005175666383482e-05, 8.88717345014915e-05, 9.86421759363562e-05, 0.00010946292970895932, 0.000121444035250496, 0.00013470673008597665, 0.00014938455356304465, 0.00016562455584306693, 0.00018358862190637228, 0.00020345492121431462, 0.00022541949464471088, 0.0002496979913824779, 0.00027652756961326724, 0.0003061689761450081, 0.0003389088214820687, 0.00037506206841222663, 0.0004149747538524066, 0.0004590269655514142, 0.000507636097285115, 0.0005612604084222419, 0.0006204029162105207, 0.0006856156518592966, 0.0007575043145059283, 0.0008367333604823555, 0.0009240315689834231, 0.0010201981293224778, 0.0011261092994916744, 0.0012427256907791345, 0.001371100238796239, 0.0015123869275072476, 0.0016678503398123185, 0.0018388761160071673, 0.002026982410135024, 0.0022338324439816477, 0.002461248269381853, 0.002711225861767474, 0.0029859516816766957, 0.003287820856475456, 0.0036194571520587458, 0.003983734924084876, 0.00438380326067592, 0.004823112553869684, 0.005305443765870441, 0.0058349406888235315, 0.0064161455340234624, 0.007054038228841107, 0.007754079848023876, 0.008522260661315315, 0.009365153342652258, 0.01028997195880493, 0.011304637438735046, 0.012417850320921629, 0.013639171686530461, 0.014979113314038455, 0.016449238238678502, 0.018062273071295012, 0.01983223362999573, 0.021774565669234896, 0.023906302760496205, 0.026246243693539836, 0.028815152135598467, 0.03163598171802319, 0.03473413022781474, 0.03813772717990072, 0.041877959752709484, 0.045989442906154, 0.05051064049392923, 0.05548434536324687, 0.06095822784432368, 0.06698546371771866, 0.07362545477005313, 0.08094465748214008, 0.08901753833063533, 0.09792767774046277, 0.10776904904516704, 0.11864750407798301, 0.1306825034576732, 0.1440091375417031, 0.15878049376665032, 0.17517043815760505, 0.19337689377656306, 0.2136257175854881, 0.23617530065079007, 0.2613220461555203, 0.28940691707833444];

/// State-Space `A` matrix, first row
#[rustfmt::skip]
const AVALS: [[f64; 100]; 6] = [[4.636187181471796, 4.608943798752584, 4.581158266620415, 4.552819910321668, 4.5239178507313795, 4.494441000684404, 4.464378061245217, 4.433717517914673, 4.402447636771837, 4.370556460548825, 4.338031804636409, 4.304861253017894, 4.271032154128522, 4.236531616637433, 4.2013465051488055, 4.165463435818617, 4.128868771882935, 4.091548619093388, 4.0534888210549225, 4.01467495446055, 3.9750923242172114, 3.934725958456345, 3.8935606034221175, 3.8515807182295916, 3.8087704694844122, 3.765113725754768, 3.720594051885539, 3.6751947031436716, 3.628898619182751, 3.5816884178137887, 3.5335463885680145, 3.4844544860363005, 3.434394322968565, 3.383347163115072, 3.3312939137901436, 3.2782151181372, 3.2240909470724417, 3.168901190882748, 3.112625250451538, 3.0552421280844726, 2.996730417904849, 2.9370682957865135, 2.8762335087899524, 2.814203364065015, 2.750954717181484, 2.686463959846346, 2.6207070069643343, 2.5536592829959206, 2.485295707564582, 2.4155906802628846, 2.344518064604662, 2.2720511710684184, 2.1981627391750926, 2.122824918541511, 2.046009248849291, 1.9676866386677667, 1.887827343068614, 1.8064009399695726, 1.7233763051448627, 1.638721585840928, 1.5524041729379146, 1.4643906716001585, 1.3746468703630352, 1.2831377086089126, 1.1898272423921636, 1.0946786085821028, 0.9976539873040877, 0.8987145626728545, 0.7978204818289647, 0.6949308123096211, 0.5900034978093065, 0.4829953124145421, 0.3738618134310009, 0.2625572929611488, 0.14903472843708027, 0.033245732367489976, -0.08485949837972465, -0.20533223336536818, -0.3282252589606397, -0.45359292775117355, -0.581491206284187, -0.7119777203577651, -0.8451117969140886, -0.980954501445335, -1.11956866965091, -1.2610189318978198, -1.405371728832474, -1.5526953162738037, -1.70305975728654, -1.8565368990947795, -2.0132003322561265, -2.173125329285794, -2.336388759712521, -2.50306897838275, -2.673245683732625, -2.8469997427522786, -3.024412979517241, -3.2055679245115796, -3.390547522583109, -3.5794347983311914], [-9.080175713619933, -8.979619180625289, -8.8777507476699, -8.77457097922629, -8.67008144257653, -8.564284762449004, -8.457184677843255, -8.348786101117406, -8.239095179415152, -8.128119358511862, -8.015867449162283, -7.902349696035191, -7.787577849323497, -7.671565239121821, -7.554326852666997, -7.435879414541075, -7.316241469940359, -7.195433471118774, -7.073477867118573, -6.9503991969069, -6.826224186042367, -6.7009818470022395, -6.574703583307611, -6.447423297591565, -6.319177503763539, -6.190005443432148, -6.059949206758575, -5.929053857923719, -5.7973675654039925, -5.664941737264118, -5.531831161689518, -5.398094152996984, -5.263792703379881, -5.128992640663384, -4.9937637923666705, -4.858180156392366, -4.722320078689447, -4.586266438264234, -4.450106839945446, -4.313933815343776, -4.177845032484378, -4.041943514632428, -3.9063378688777615, -3.771142525095064, -3.6364779859515193, -3.502471088694557, -3.3692552795192956, -3.2369709013883785, -3.105765496257295, -2.9757941227462816, -2.847219690396342, -2.7202133117524006, -2.594954673632109, -2.4716324290650356, -2.3504446115249205, -2.231599073228354, -2.1153139494375828, -2.00181815088451, -1.8913518866283037, -1.78416721987193, -1.6805286594943996, -1.5807137903073456, -1.4850139453180529, -1.3937349235777536, -1.3071977575157998, -1.2257395340084334, -1.1497142738074797, -1.0794938743606481, -1.0154691214929903, -0.9580507758900156, -0.9076707408281368, -0.8647833181387009, -0.8298665599684095, -0.803423724511713, -0.7859848445390458, -0.7781084182272592, -0.7803832325123908, -0.7934303299259207, -0.8179051306375023, -0.854499722201234, -0.903945330276801, -0.9670149843557436, -1.0445263932458446, -1.137345045727048, -1.2463875523565133, -1.3726252448264968, -1.517088049513907, -1.680868651840372, -1.8651269677073394, -2.0710949374874055, -2.300081656727426, -2.553478855717594, -2.8327667372500085, -3.139520178054525, -3.4754152943660674, -3.842236365638558, -4.241883102366315, -4.676378234107438, -5.14787538196896, -5.658667165933624], [9.596669428620086, 9.445521091693202, 9.293304492496627, 9.14005773006395, 8.985821012727737, 8.830636701149201, 8.674549349782335, 8.517605746549465, 8.359854950490488, 8.201348327132886, 8.042139581313705, 7.882284787168007, 7.7218424149806575, 7.560873354580316, 7.399440934934892, 7.237610939588065, 7.075451617554888, 6.913033689272794, 6.750430347180662, 6.587717250474457, 6.42497251356198, 6.262276687712255, 6.099712735366374, 5.937365996546366, 5.775324146766611, 5.613677145818329, 5.452517176761376, 5.2919385744193566, 5.1320377426325665, 4.972913059479649, 4.814664769631287, 4.657394862948644, 4.501206938384477, 4.34620605218542, 4.192498549329916, 4.040191877066227, 3.889394379338928, 3.7402150708090884, 3.5927633890821205, 3.447148923657293, 3.30348112000264, 3.1618689570375818, 3.022420596171174, 2.88524299989518, 2.7504415177661703, 2.6181194374272865, 2.4883774981163143, 2.3613133638789434, 2.2370210534521164, 2.1155903234983686, 1.9971060015544042, 1.8816472647012812, 1.7692868595646258, 1.660090258805667, 1.5541147487611202, 1.4514084423250027, 1.3520092105299377, 1.2559435255704383, 1.1632252072052385, 1.073854063568339, 0.9878144163952087, 0.9050734995163733, 0.8255797181678359, 0.7492607551963877, 0.676021508575456, 0.6057418427674607, 0.5382741343427382, 0.4734405898589067, 0.41103031128002593, 0.3507960811282522, 0.2924508360618886, 0.23566379360582906, 0.18005619225817565, 0.1251966000859381, 0.07059574111811584, 0.01570078224927389, -0.040110984129956936, -0.09753913508316828, -0.1573678726625159, -0.22047463406074963, -0.2878396629653709, -0.36055666298109273, -0.4398446702367783, -0.527061300779128, -0.6237175493770626, -0.731494340252532, -0.8522610573850982, -0.9880963128154396, -1.1413112462373078, -1.3144756885898516, -1.5104475668366817, -1.7324059771482263, -1.9838884097839378, -2.2688326715530884, -2.5916241211870243, -2.9571489095054306, -3.3708539998999663, -3.8388148350435287, -4.367811612024403, -4.965415228778568], [-5.763952273177787, -5.648658746566937, -5.533165463109357, -5.417518283851459, -5.3017643922966355, -5.185952275958465, -5.070131704311356, -4.954353702977324, -4.838670523988684, -4.7231356119683845, -4.607803566072532, -4.492730097543434, -4.377971982726047, -4.2635870114067185, -4.149633930339958, -4.036172381837309, -3.9232628373018734, -3.810966525603229, -3.6993453561999634, -3.5884618369314567, -3.4783789864165167, -3.369160241014565, -3.2608693563250526, -3.153570303223094, -3.047327158453924, -2.942203989835906, -2.8382647361516233, -2.7355730818395148, -2.6341923266341505, -2.5341852503428077, -2.435613972988631, -2.338539810597682, -2.243023126958276, -2.1491231817366816, -2.0568979753942163, -1.9664040914170744, -1.8776965364427762, -1.790828578946327, -1.7058515872358446, -1.6228148676023526, -1.5417655035725424, -1.4627481973277865, -1.3858051144786077, -1.3109757335228291, -1.2382967014693131, -1.1678016972794174, -1.0995213049676273, -1.0334828984134299, -0.9697105401718673, -0.9082248968336191, -0.8490431737811788, -0.7921790725204767, -0.7376427741427753, -0.685440952896418, -0.6355768243296236, -0.5880502330129852, -0.5428577854740146, -0.4999930346882594, -0.45944672328642144, -0.4212070935713699, -0.3852602735124761, -0.3515907491205016, -0.3201819350313672, -0.29101685677338446, -0.26407896009760884, -0.23935306495897612, -0.21682648429930879, -0.19649033076375494, -0.1783410379530102, -0.1623821268615025, -0.1486262528794908, -0.13709757426717994, -0.12783448948713733, -0.12089279838125526, -0.11634935110763035, -0.1143062592591344, -0.114895755966222, -0.11828580639817113, -0.1246865873477736, -0.1343579750299685, -0.14761820446632873, -0.16485389261473127, -0.18653165164374869, -0.21321155954234464, -0.24556280392869506, -0.28438187309413443, -0.33061373795487814, -0.38537655207817234, -0.44999049721674744, -0.5260115223828568, -0.6152708697628764, -0.7199214560187333, -0.8424923892229974, -0.9859531577455095, -1.153789337516162, -1.350092040019255, -1.5796637794834054, -1.848143991447834, -2.1621581072976923, -2.529494905841446], [1.8632581153773466, 1.8187232961884137, 1.7743262398007398, 1.7300879139768803, 1.6860295453683134, 1.642172594796793, 1.598538730993374, 1.5551498027898938, 1.5120278097628848, 1.469194871335512, 1.4266731943490838, 1.3844850391220338, 1.342652684020929, 1.3011983885751506, 1.2601443551742373, 1.2195126893946502, 1.1793253590106552, 1.1396041517524305, 1.1003706318829678, 1.0616460956742195, 1.0234515258718468, 0.9858075452471134, 0.9487343693436425, 0.9122517585360677, 0.8763789695268366, 0.8411347064165999, 0.8065370714926017, 0.7726035158882854, 0.739350790275668, 0.7067948957600743, 0.6749510351541408, 0.6438335648147414, 0.6134559472323392, 0.583830704567107, 0.5549693733298806, 0.5268824604082991, 0.49957940063924167, 0.473068516127567, 0.44735697750796066, 0.42245076734109926, 0.39835464582695984, 0.3750721190066163, 0.35260540960872827, 0.3309554306777337, 0.3101217620968397, 0.29010263008961323, 0.2708948897485594, 0.25249401059655296, 0.23489406513637537, 0.218087720283608, 0.20206623150732098, 0.18681943941962653, 0.1723357684572367, 0.15860222718325634, 0.1456044096027086, 0.13332649672734492, 0.1217512574400684, 0.11086004749199004, 0.10063280520992768, 0.09104804219213083, 0.08208282691679615, 0.07371275877152081, 0.06591192952010015, 0.05865286864138436, 0.05190646828561067, 0.045641882775240276, 0.03982639660388752, 0.034425253726748414, 0.029401439550489558, 0.024715405372803034, 0.02032472303422258, 0.01618365515685936, 0.012242623469902127, 0.008447554253586535, 0.004739075740604971, 0.0010515372344398145, -0.0026881864630032156, -0.00656214922609924, -0.010663099445342864, -0.01509662178038843, -0.01998373277768671, -0.02546402513232872, -0.031699476089732656, -0.038879061048553626, -0.04722434505780458, -0.05699626414082433, -0.06850335718776845, -0.08211177003893971, -0.09825742953561785, -0.1174608808540757, -0.14034540165716855, -0.16765915833894668, -0.20030236177397648, -0.23936062405886233, -0.28614602882169204, -0.3422478255238317, -0.4095951687517616, -0.49053498104973403, -0.5879288677258494, -0.7052741145099004], [-0.2530289902337204, -0.24607082594954954, -0.23916486068161527, -0.23231450096051262, -0.22552314524044792, -0.21879417822584246, -0.21213096503307186, -0.20553684519760118, -0.1990151265379052, -0.1925690788887146, -0.186201927717294, -0.17991684763763163, -0.17371695583858945, -0.16760530544323893, -0.16158487881776035, -0.1556585808494321, -0.1498292322143406, -0.14409956265653628, -0.1384722043013896, -0.1329496850269028, -0.1275344219176564, -0.12222871482694353, -0.11703474007342768, -0.1119545442993739, -0.10699003851811159, -0.10214299237890322, -0.09741502867779625, -0.09280761814332934, -0.08832207452612333, -0.08395955002143835, -0.07972103105367459, -0.07560733445157392, -0.07161910404251384, -0.06775680769378059, -0.06402073482807788, -0.06041099443975832, -0.05692751363738355, -0.05357003673722134, -0.05033812493119943, -0.04723115655167512, -0.04424832795416603, -0.041388655037964295, -0.03865097542335055, -0.036033951302994235, -0.0335360729841255, -0.03115566313725999, -0.02889088176674358, -0.026739731918249826, -0.024700066138737264, -0.022769593705398914, -0.02094588864198467, -0.01922639854375711, -0.017608454236500343, -0.016089280300740038, -0.014666006500008173, -0.013335680162033752, -0.01209527957468234, -0.010941728474940099, -0.009871911730009869, -0.008882692335599301, -0.007970929888874625, -0.007133500733733477, -0.006367320025731452, -0.005669366025291266, -0.00503670700333665, -0.004466531236436783, -0.0039561806829096005, -0.0035031890720561122, -0.0031053253119411165, -0.0027606433345823984, -0.002467539760670886, -0.0022248210910770145, -0.002031782534565326, -0.0018883010794618189, -0.0017949460356739286, -0.0017531110431111656, -0.0017651725021851647, -0.0018346805814161294, -0.0019665904598717586, -0.0021675433498913373, -0.002446209223480789, -0.0028137061698084616, -0.0032841151176056767, -0.0038751134943071455, -0.00460875756300848, -0.005512451071589352, -0.006620147982840324, -0.007973850113932868, -0.009625477406066492, -0.01163921048172226, -0.014094433750628611, -0.017089444781789212, -0.02074614492555875, -0.02521599127088124, -0.030687576463152254, -0.03739631826068689, -0.045636895452551896, -0.05577927549044804, -0.0682894623532887, -0.08375647961867891]];

/// State-Space `C` vector
#[rustfmt::skip]
const CVALS: [[f64; 100]; 6] = [[0.0001732122297792267, 0.00019238101333751305, 0.0002136191260997709, 0.00023714324533785825, 0.00026319188640688254, 0.0002920274983988169, 0.00032393874815338426, 0.00035924300804938703, 0.00039828906408815, 0.00044146006192595597, 0.0004891767097147986, 0.000541900757870636, 0.0006001387772052886, 0.0006644462582314602, 0.0007354320558786713, 0.0008137632053392621, 0.0009001701362952284, 0.0009954523143549023, 0.0011004843401489434, 0.0012162225381917664, 0.0013437120693010254, 0.001484094602075192, 0.0016386165806482533, 0.0018086381276591602, 0.0019956426230782467, 0.00220124700120777, 0.0024272128098002813, 0.0026754580767954757, 0.002948070031639265, 0.0032473187294896587, 0.0035756716278002327, 0.003935809165767267, 0.0043306413978877484, 0.004763325733355091, 0.005237285833161837, 0.00575623171652086, 0.006324181127486508, 0.006945482211372226, 0.007624837548626683, 0.008367329591138686, 0.00917844754236516, 0.010064115718077403, 0.011030723418727895, 0.012085156337268154, 0.01323482951747316, 0.014487721867197186, 0.01585241221820235, 0.017338116908920894, 0.018954728848335975, 0.020712857997623076, 0.022623873180742028, 0.024699945105167424, 0.026954090438639822, 0.029400216746336073, 0.03205316804415084, 0.03492877066663571, 0.03804387908111079, 0.04141642120084672, 0.04506544265798531, 0.04901114938864189, 0.05327494775556315, 0.05787948128443219, 0.062848662914387, 0.06820770145677546, 0.07398312071286714, 0.08020276941436989, 0.08689581981194258, 0.09409275233666296, 0.10182532328580755, 0.11012651192315034, 0.11903044271822097, 0.12857227765797236, 0.13878807262318194, 0.14971459070048274, 0.16138906396259914, 0.17384889364961942, 0.18713127676879757, 0.2012727448332077, 0.2163085976996112, 0.23227221214377963, 0.24919420080508672, 0.2671013922908971, 0.2860155973689458, 0.30595211906192243, 0.32691795580591637, 0.34890963628569516, 0.3719106116674128, 0.39588811515161076, 0.4207893793584696, 0.44653707813829463, 0.4730238298367425, 0.5001055623876913, 0.5275934950018892, 0.5552444342803038, 0.58274901122326, 0.6097173958232686, 0.6356619124886939, 0.6599758355766889, 0.6819074607441734, 0.7005283126020667], [9.640540797658484e-05, 0.00010917269284103643, 0.0001235998462638484, 0.00013989800396032359, 0.00015830446698274399, 0.00017908584374399722, 0.0002025415550215728, 0.00022900774188220789, 0.000258861620592156, 0.0002925263330930832, 0.0003304763465613053, 0.00037324346096293833, 0.0004214234894061234, 0.0004756836825126116, 0.0005367709750256987, 0.0006055211404830617, 0.000682868948057031, 0.0007698594246488989, 0.0008676603350681099, 0.0009775760036832594, 0.001101062612354075, 0.001239745121797174, 0.0013954359768608602, 0.0015701557705437102, 0.0017661560570472392, 0.001985944520764179, 0.002232312725929712, 0.0025083666907611962, 0.0028175605503391026, 0.003163733594290265, 0.0035511509885729187, 0.0039845485153740595, 0.004469181691347071, 0.005010879652166289, 0.005616104220665708, 0.006292014606655903, 0.007046538218850539, 0.00788844810313003, 0.008827447556542264, 0.009874262502868592, 0.011040742253097396, 0.012339969312527475, 0.013786378935169208, 0.01539588916525109, 0.01718604214448775, 0.01917615750172274, 0.021387498677868422, 0.023843453072792207, 0.026569726930786408, 0.029594555906081822, 0.03294893226777597, 0.036666849712404026, 0.04078556674955573, 0.045345889608241416, 0.050392475575214216, 0.05597415761639898, 0.06214429104313718, 0.06896112285904009, 0.07648818425218233, 0.0847947064706196, 0.09395606002388, 0.10405421677344251, 0.11517823399204104, 0.12742475886146848, 0.14089855111262367, 0.1557130205547363, 0.17199077504985605, 0.18986417301099412, 0.20947587267282625, 0.2309793681228119, 0.25453949928976277, 0.2803329196452863, 0.3085485011317892, 0.33938765060430054, 0.3730645056338967, 0.4098059695847686, 0.449851536093534, 0.4934528410108761, 0.5408728649672168, 0.5923846913155976, 0.6482697014352605, 0.7088150611819029, 0.7743103173048239, 0.845042879229813, 0.9212921075991864, 1.0033216636715905, 1.0913696896939502, 1.1856362853155664, 1.2862676134682507, 1.3933358037822283, 1.506813613423484, 1.6265425424736881, 1.7521927684373488, 1.8832128424378953, 2.01876655247033, 2.1576536731059104, 2.2982104421255607, 2.438184474364716, 2.574577364163045, 2.7034463369097703], [0.00048198710856652764, 0.0005339607121433824, 0.0005913917879862014, 0.0006548361403079481, 0.0007249042628037891, 0.0008022665249661841, 0.0008876588332212454, 0.0009818888093497547, 0.0010858425324803483, 0.0012004918951314092, 0.0013269026283705275, 0.0014662430561989644, 0.0016197936448010088, 0.0017889574183777622, 0.001975271319970859, 0.002180418603040109, 0.002406242347663317, 0.0026547602041583286, 0.002928180476777849, 0.0032289196709968404, 0.003559621639913746, 0.00392317847854305, 0.004322753329426693, 0.004761805279187147, 0.005244116543553822, 0.005773822158203148, 0.006355442414665333, 0.006993918304792228, 0.007694650264099513, 0.008463540533962411, 0.00930703949545392, 0.01023219636389371, 0.011246714673273882, 0.012359013024030653, 0.013578291616551403, 0.014914605146792357, 0.016378942699914276, 0.017983315343436546, 0.01974085219361177, 0.021665905808115025, 0.023774167845328376, 0.026082796026127553, 0.028610553538784597, 0.031377962142066236, 0.034407470346487695, 0.037723638189628705, 0.04135334026903911, 0.04532598885609986, 0.0496737790867043, 0.05443195841006841, 0.05963912267545482, 0.06533754144789106, 0.07157351536747367, 0.07839776860147214, 0.0858658796823726, 0.0940387542755553, 0.10298314367364805, 0.11277221306543184, 0.12348616386825766, 0.1352129146346262, 0.14804884523307432, 0.16209960914405788, 0.17748101878122782, 0.19432000871909075, 0.21275568154288907, 0.23294044068865832, 0.25504121405032437, 0.2792407712190671, 0.30573913588893714, 0.3347550930852434, 0.3665277882867786, 0.40131841201283647, 0.439411958767176, 0.4811190430361633, 0.5267777468959088, 0.57675546314113, 0.6314506839998365, 0.6912946675360077, 0.75675289060353, 0.8283261672025002, 0.9065512723770075, 0.9920008618970559, 1.0852824136753365, 1.1870358340256537, 1.2979292650804715, 1.4186524919382497, 1.5499071702673983, 1.6923928652122986, 1.846787594886162, 2.0137211859510216, 2.1937392477138253, 2.387254919054697, 2.594484691962096, 2.8153635034698987, 3.0494328303039517, 3.2956936049763503, 3.5524132471052186, 3.816872765206683, 4.0850354554343475, 4.351112828192071], [0.00015041070581167223, 0.00016957583530717484, 0.00019112245273575546, 0.00021533778003124163, 0.00024254246000527806, 0.00027309427970785154, 0.000307392287072108, 0.00034588133973785095, 0.00038905712849594495, 0.0004374717216384542, 0.0004917396806593877, 0.0005525448022529188, 0.0006206475464264562, 0.000696893215813835, 0.0007822209569706078, 0.0008776736605933914, 0.0009844088442661123, 0.0011037106085392252, 0.001237002764939508, 0.0013858632429380765, 0.0015520398920297071, 0.001737467804959349, 0.0019442882988423994, 0.0021748697025419958, 0.002431830111277235, 0.0027180622831402016, 0.0030367608671083898, 0.003391452168378452, 0.0037860266745605065, 0.0042247745856201085, 0.004712424611620563, 0.0052541863255092715, 0.005855796383641911, 0.006523568954714947, 0.007264450728580989, 0.008086080910394358, 0.008996856643062292, 0.010006004342496561, 0.011123657476163326, 0.012360941366471118, 0.01373006565723853, 0.015244425144549613, 0.016918709743511333, 0.01876902444065436, 0.020813020168931176, 0.0230700366395439, 0.025561258273361507, 0.028309884495765977, 0.03134131579381783, 0.034683357085186536, 0.03836644011599944, 0.042423866791368836, 0.04689207554967681, 0.051810933121606284, 0.05722405426925227, 0.06317915238121524, 0.06972842410795964, 0.07692897155919114, 0.08484326595230238, 0.09353965699803499, 0.10309293273520581, 0.11358493497785124, 0.1251052360103481, 0.13775188265080446, 0.1516322142877592, 0.16686376196181446, 0.18357523598618394, 0.2019076099419269, 0.22201530909453546, 0.24406751128972937, 0.26824956810435246, 0.29476455332696355, 0.32383494455239265, 0.35570444156777714, 0.3906399219803414, 0.42893352978337385, 0.470904885735122, 0.5169033988136849, 0.5673106446472486, 0.6225427584198817, 0.6830527646060968, 0.749332731705051, 0.8219155938677244, 0.9013764188392293, 0.9883328174727929, 1.0834440768158815, 1.1874084464544536, 1.3009578029631832, 1.4248486417092292, 1.5598479741235045, 1.70671220814049, 1.8661564136996769, 2.038810460768094, 2.225157277282135, 2.425446788569797, 2.639576801637059, 2.8669289553463746, 3.1061435469357077, 3.3548111116220247, 3.6090504337100917], [0.0001280545789817174, 0.00014178356858702656, 0.00015695302305417536, 0.00017371073800609898, 0.00019221934679810665, 0.00021265778187184612, 0.00023522287802549968, 0.000260131131282576, 0.00028762062835849093, 0.00031795316316732215, 0.0003514165583926204, 0.000388327211879022, 0.00042903288949983266, 0.00047391578823530254, 0.0005233958954738824, 0.0005779346730428882, 0.0006380390972058201, 0.0007042660888531024, 0.0007772273713853644, 0.0008575947973695874, 0.0009461061889675598, 0.0010435717414240889, 0.0011508810435939946, 0.001269010774619535, 0.0013990331414848525, 0.0015421251283168225, 0.001699578635022076, 0.0018728115902028563, 0.0020633801313407526, 0.0022729919540440003, 0.0025035209417952455, 0.002757023198195354, 0.0030357546152660142, 0.003342190124052355, 0.003679044787670416, 0.0040492969122006076, 0.00445621336758053, 0.00490337732905912, 0.005394718670019599, 0.0059345472592649854, 0.006527589440414449, 0.007179027998143445, 0.007894545945903273, 0.008680374502810586, 0.00954334566397426, 0.01049094980904932, 0.011531398838750026, 0.012673695378953805, 0.01392770864749026, 0.01530425764041258, 0.016815202363257387, 0.018473543909365106, 0.02029353427270316, 0.02229079687786336, 0.024482458916144326, 0.026887296695143347, 0.029525895341426717, 0.032420824343073126, 0.03559683058269105, 0.03908105069343339, 0.04290324477204907, 0.047096053705475746, 0.05169528261195243, 0.056740213164726556, 0.06227394785596911, 0.06834378956920562, 0.07500166015737851, 0.08230456206511426, 0.09031508737885337, 0.09910197902321377, 0.10874074912531263, 0.11931435981003251, 0.13091397182411846, 0.1436397663525492, 0.15760184509800906, 0.17292121301897745, 0.18973084689034092, 0.20817685082109477, 0.2284196967018657, 0.25063554279693595, 0.2750176166992927, 0.30177763874458796, 0.3311472475002845, 0.36337936840417095, 0.39874943765384935, 0.4375563527527565, 0.4801229641088999, 0.5267958423469744, 0.5779439445476064, 0.6339556468413509, 0.695233392852453, 0.7621849022066993, 0.8352094548835821, 0.9146771645235422, 1.000898303699876, 1.0940785412577967, 1.1942542436687844, 1.30119955727559, 1.4142935022251044, 1.5323302952945441], [1.216455784150219e-05, 1.3671639820129326e-05, 1.536022177079693e-05, 1.72514486353523e-05, 1.936883461784812e-05, 2.17385167873564e-05, 2.4389534418792907e-05, 2.735413653145e-05, 3.066812030586531e-05, 3.4371203299524384e-05, 3.850743264234917e-05, 4.312563467576617e-05, 4.827990880635766e-05, 5.40301696788623e-05, 6.0442742136012334e-05, 6.759101382703821e-05, 7.55561507555763e-05, 8.442788152443817e-05, 9.430535654287166e-05, 0.00010529808901554647, 0.00011752698513604385, 0.00013112547156603698, 0.00014624072900019667, 0.0001630350414022943, 0.00018168727135689573, 0.00020239447292115997, 0.0002253736543911657, 0.0002508637045264962, 0.0002791274970163418, 0.00031045418933213823, 0.00034516173360928006, 0.00038359961884892814, 0.000426151865547268, 0.0004732402958629461, 0.0005253281046451428, 0.0005829237590889171, 0.0006465852574880728, 0.0007169247805492421, 0.0007946137720482924, 0.0008803884892900771, 0.0009750560679179901, 0.0010795011501599698, 0.001194693130646864, 0.0013216940795599316, 0.0014616674091261271, 0.0016158873564617612, 0.0017857493635559155, 0.001972781443885006, 0.002178656634872444, 0.002405206646279912, 0.002654436826783624, 0.0029285425846123777, 0.0032299274133863964, 0.0035612226914027542, 0.003925309441793938, 0.004325342262498265, 0.00476477565911047, 0.005247393040745223, 0.005777338669393623, 0.006359152887264303, 0.006997810984685573, 0.007698766113738569, 0.008467996700342019, 0.009312058860469782, 0.010238144384975879, 0.011254144922498342, 0.012368723061358736, 0.01359139108932631, 0.014932598294313938, 0.016403827758775937, 0.018017703694323497, 0.01978811045833255, 0.0217303244870104, 0.02386116046318762, 0.026199133102470785, 0.028764635974180622, 0.0315801387530149, 0.03467040419357339, 0.03806272588946754, 0.04178718745954048, 0.04587694310673422, 0.05036851839313049, 0.05530212838584898, 0.060722007793015086, 0.06667674395519799, 0.07321959805300969, 0.08040879187118799, 0.08830772582247558, 0.09698507709094338, 0.1065147023999153, 0.11697523469207843, 0.12844921203088733, 0.1410215031036582, 0.15477668622184426, 0.16979488194255965, 0.18614530991263167, 0.2038765030460628, 0.22300161349175027, 0.24347650412249852, 0.2651672125265582]];

#[cfg(feature = "std")]
#[cfg(test)]
#[rustfmt::skip]
mod test {
    use super::*;
    const CUTOFF_TEST_INPUT: [f32; 101] = [0.0, 0.5877852522924732, -0.9510565162951536, 0.9510565162951535, -0.5877852522924728, -4.898587196589413e-16, 0.5877852522924737, -0.9510565162951538, 0.9510565162951533, -0.5877852522924724, -9.797174393178826e-16, 0.587785252292474, -0.951056516295154, 0.9510565162951532, -0.587785252292472, -1.4695761589768238e-15, 0.5877852522924744, -0.9510565162951541, 0.951056516295153, -0.5877852522924716, -1.959434878635765e-15, 0.5877852522924748, -0.9510565162951542, 0.9510565162951529, -0.5877852522924712, -2.4492935982947065e-15, 0.5877852522924751, -0.9510565162951544, 0.9510565162951528, -0.5877852522924709, -2.9391523179536475e-15, 0.5877852522924756, -0.9510565162951545, 0.9510565162951525, -0.5877852522924705, -3.429011037612589e-15, 0.587785252292476, -0.9510565162951546, 0.9510565162951524, -0.58778525229247, -3.91886975727153e-15, 0.5877852522924764, -0.9510565162951549, 0.9510565162951523, -0.5877852522924696, -4.408728476930472e-15, 0.5877852522924768, -0.951056516295155, 0.9510565162951521, -0.5877852522924693, -4.898587196589413e-15, 0.5877852522924887, -0.9510565162951552, 0.9510565162951563, -0.5877852522924689, -1.9599300631450357e-14, 0.5877852522924776, -0.9510565162951509, 0.9510565162951518, -0.5877852522924569, -5.878304635907295e-15, 0.5877852522924665, -0.9510565162951554, 0.9510565162951473, -0.587785252292468, 7.842691359635767e-15, 0.5877852522924784, -0.95105651629516, 0.9510565162951515, -0.5877852522924791, -6.858022075225178e-15, 0.5877852522924902, -0.9510565162951558, 0.9510565162951558, -0.5877852522924673, -2.1558735510086122e-14, 0.5877852522924791, -0.9510565162951515, 0.9510565162951512, -0.5877852522924554, -7.83773951454306e-15, 0.587785252292468, -0.9510565162951561, 0.9510565162951466, -0.5877852522924665, 5.883256481000002e-15, 0.5877852522924799, -0.9510565162951606, 0.9510565162951509, -0.5877852522924776, -8.817456953860943e-15, 0.5877852522924919, -0.9510565162951563, 0.9510565162951552, -0.5877852522924657, -2.3518170388721888e-14, 0.5877852522924807, -0.9510565162951521, 0.9510565162951506, -0.5877852522924538, -9.797174393178826e-15];
    const CUTOFF_TEST_OUTPUT: [f32; 101] = [0.0, 0.1701091177700757, 0.13651787661258524, -0.2758226226829054, 0.12500969241519752, 0.15993667325805636, -0.36025338584378547, 0.34143187081754334, -0.11084618772932286, -0.20661827917658682, 0.4441181378398668, -0.47774028965058296, 0.2831445488985825, 0.0568645745964646, -0.39249299021777495, 0.57437860375767, -0.5184536662685013, 0.2414452351223122, 0.14647971190026154, -0.4875905989378314, 0.641409621716717, -0.5419553416347525, 0.22459926628426774, 0.18776834826674965, -0.53334985831582, 0.6753476535674523, -0.5559404854843859, 0.21923792169315054, 0.20561875187294804, -0.5544955516701225, 0.6919214627279744, -0.5636612562519017, 0.21788545432784956, 0.2132007916296501, -0.5641499158491075, 0.6999016130363221, -0.5677646708791441, 0.21777606568816182, 0.21637396542279025, -0.56852575452543, 0.7037118564387821, -0.5698955587112728, 0.21796470610646468, 0.21767715004985588, -0.5704947287718998, 0.7055180140251617, -0.5709831024228894, 0.21816286157490206, 0.2181991990635273, -0.5713737089154466, 0.7063682547820637, -0.5715303120408592, 0.21830564924913393, 0.21840136992415887, -0.5717627139913366, 0.7067657868108222, -0.5718023251266152, 0.21839511038159093, 0.21847591065110133, -0.5719332336685045, 0.7069504064043995, -0.5719361140603962, 0.2184471371651749, 0.21850130233736653, -0.5720071806723808, 0.7070355703324598, -0.5720012982704522, 0.21847600745573537, 0.2185087273885834, -0.572038854387965, 0.7070745882123421, -0.572032785223034, 0.21849151340572903, 0.21851012279351933, -0.5720522251377382, 0.707092338991631, -0.57204787441148, 0.2184996413657473, 0.21850981237222405, -0.5720577706759963, 0.7071003555055602, -0.5720550516366045, 0.21850382147793124, 0.21850922371482967, -0.5720600201825059, 0.7071039478803954, -0.5720584412675743, 0.21850593814121544, 0.2185087455857852, -0.5720609063899899, 0.7071055443192412, -0.5720600311085795, 0.2185069960463651, 0.21850842986800206, -0.5720612415291757, 0.7071062473251327, -0.5720607717654319, 0.21850751886088865, 0.21850824069574426, -0.5720613606056791, 0.7071065537691548];
    const STEP_TEST_MIN_OUTPUT: f32 = 1.000000155482648;
    const STEP_TEST_MAX_OUTPUT: f32 = 0.9899352296804012;

    #[test]
    fn test() {
        println!("order 6");
        let mut filter = butter6(0.4).unwrap();
        let out = (0..CUTOFF_TEST_INPUT.len()).map(|i| {filter.update(CUTOFF_TEST_INPUT[i])}).collect::<Vec<f32>>();
        // Check overall match to reference output to catch phase error, etc
        (0..CUTOFF_TEST_INPUT.len()).for_each(|i| { let expected = CUTOFF_TEST_OUTPUT[i]; let rel_err = (out[i] - expected).abs() / expected.abs().max(1e-4); assert!(rel_err < 0.05); });
        // Check approximate attenuation at cutoff frequency; should be -3dB or 1/sqrt(2) magnitude
        let maxmag = out.iter().fold(0.0_f32, |a, b| a.abs().max(b.abs()));
        let attenuation_rel_err = (maxmag - 0.707).abs() / 0.707;
        println!("attenuation rel err {attenuation_rel_err}");
        assert!(attenuation_rel_err < 0.05);
        // Check convergence of step responses at min and max tabulated cutoff
        let mut filtermin = butter6(MIN_CUTOFF_RATIO).unwrap();
        (0..169).for_each(|_| {filtermin.update(1.0);});
        let step_min_final = filtermin.update(1.0);
        let step_min_rel_err = (step_min_final - STEP_TEST_MIN_OUTPUT).abs() / STEP_TEST_MIN_OUTPUT;
        println!("step min rel err {step_min_rel_err}");
        assert!(step_min_rel_err < 1e-3);
        let mut filtermax = butter6(MAX_CUTOFF_RATIO).unwrap();
        (0..1).for_each(|_| {filtermax.update(1.0);});
        let step_max_final = filtermax.update(1.0);
        let step_max_rel_err = (step_max_final - STEP_TEST_MAX_OUTPUT).abs() / STEP_TEST_MAX_OUTPUT;
        println!("step max rel err {step_max_rel_err}");
        assert!(step_max_rel_err < 1e-6);
    }
}
